<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="General description"><meta name="keywords" content="rust, rustlang, rust-lang, massa_execution_worker"><title>massa_execution_worker - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../massa_execution_worker/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../massa_execution_worker/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate massa_execution_worker</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#functions">Functions</a></li></ul></div></section><div id="sidebar-vars" data-name="massa_execution_worker" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../massa_execution_worker/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">massa_execution_worker</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/massa_execution_worker/lib.rs.html#3-83">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="general-description"><a href="#general-description">General description</a></h2>
<p>The execution worker launches a persistent thread allowing the execution
of operations that can contain executable bytecode and managing interactions with the ledger.
When the worker is launched, a ExecutionManager and a ExecutionController are returned.
ExecutionManager allows stopping the worker,
and ExecutionController is the clonable structure through which users interact with the worker.</p>
<p>The worker is fed through the ExecutionController with information about blockclique changes and newly finalized blocks
and will execute the operations in those blocks, as well as pending asynchronous operations on empty slots.
The worker can also query the current state of the ledger, and simulate operations in a read-only context.</p>
<p>The execution worker has shared read access to the final ledger,
and must be the only module with runtime write access to the final ledger.</p>
<h2 id="a-note-on-finality"><a href="#a-note-on-finality">A note on finality</a></h2>
<p>The operations contained in a final slot are ready to be executed as final
only once all the previous slots are final and their operations are executed as final or ready to be so.
This ensures the sequentiality of the final executions of operations,
thus ensuring that writes to the final ledger are irreversible.</p>
<p>Slots are called “active” if they have not been executed as final, and are not ready to be executed as final.
Active slots can therefore be final slots, or slots containing blocks from the blockclique, or empty (miss) slots.
Active slots can be executed in a speculative way: their execution might need to be reverted
as new blocks finalize or arrive, causing changes to them or to active slots before them.</p>
<p>Miss slots are executed as well because they can contain implicit and async operations.</p>
<h2 id="architecture"><a href="#architecture">Architecture</a></h2>
<p>This crate is meant to be included only at the binary level to launch the worker,
not by the lib crates that will interact with it.
It depends on the massa-execution-exports crate that contains all the publicly exposed elements
and throuh which users will actually interact with the worker.</p>
<h3 id="workerrs"><a href="#workerrs">worker.rs</a></h3>
<p>This module runs the main loop of the worker thread.
It contains the logic to process incoming blockclique change notifications and read-only execution requests.
It sequences the blocks according to their slot number into queues,
and requests the execution of active and final slots to execution.rs.</p>
<h3 id="controllerrs"><a href="#controllerrs">controller.rs</a></h3>
<p>Implements ExecutionManager and ExecutionController
that serve as interfaces for users to interact with the worker in worker.rs.</p>
<h3 id="executionrs"><a href="#executionrs">execution.rs</a></h3>
<p>Contains the machinery to execute final and non-final slots,
and track the state and results of those executions.
This module initializes and holds a reference to the interface from interface_impl.rs
that allows the crate to provide execution state access
to the virtual machine runtime (massa-sc-runtime crate).
It also serves as an access point to the current execution state and speculative ledger
as defined in speculative_ledger.rs.</p>
<h3 id="speculative_ledgerrs"><a href="#speculative_ledgerrs">speculative_ledger.rs</a></h3>
<p>A speculative (non-final) ledger that supports cancelling already-executed operations
in the case of some blockclique changes.</p>
<h3 id="request_queuers"><a href="#request_queuers">request_queue.rs</a></h3>
<p>This module contains the implementation of a generic finite-size execution request queue.
It handles requests that come with an MPSC to send back the result of their execution once it’s done.</p>
</div></details><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.start_execution_worker.html" title="massa_execution_worker::start_execution_worker fn">start_execution_worker</a></div><div class="item-right docblock-short"><p>Launches an execution worker thread and returns an ExecutionManager to interact with it</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="massa_execution_worker" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0-nightly (5f3700105 2022-03-22)" ></div>
</body></html>